import{c as M,r,x as R,j as e,B as j,h as _,i as F,k as I,l as L,m as S,n as q,F as U}from"./index-C2MjUc6j.js";import{s as g}from"./index-z1pI4DUj.js";import{U as H}from"./UserProfile-DNAH9lMW.js";import{A as O}from"./ApiKeyManagement-IyDUjAdz.js";import{I as P}from"./index-C0NKCsYR.js";import{L as b}from"./label-CPXGueWk.js";import{T as B}from"./textarea-BKVa-xUV.js";import{P as E}from"./progress-Dbp9893P.js";import{P as D}from"./plus-XtvXWcDu.js";import{a as Y}from"./index-BOT--vBY.js";import{C as k}from"./circle-check-big-BtjQXCTU.js";import{P as $}from"./play-BdfUVeBd.js";import{S as W}from"./SDKDocumentation-CJ02c9Sc.js";import{L as G}from"./Layout-lstxxF2Q.js";import{T as J,a as Q,b as N,c as y}from"./tabs-CyOF3ppl.js";import"./select-JOWFLGTk.js";import"./index-BdQq_4o_.js";import"./index-CdTD_yct.js";import"./badge-BmD5Ofur.js";import"./alert-dialog-BE3E0pZr.js";import"./trash-2-DBuHC0nM.js";import"./code-DFXLlMDu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=M("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);function Z({user:s}){const[i,n]=r.useState([]),[a,o]=r.useState(!1),[x,p]=r.useState(""),[u,m]=r.useState(""),[l,h]=r.useState(""),[w,A]=r.useState(""),{toast:v}=R();r.useEffect(()=>{C()},[s]);const C=async()=>{try{const{data:t,error:c}=await g.from("ab_tests").select("*").eq("user_id",s.id).order("created_at",{ascending:!1});if(c)throw c;n(t||[])}catch(t){v({title:"Error fetching tests",description:t.message,variant:"destructive"})}},V=async()=>{if(!x||!l||!w){v({title:"Missing information",description:"Please fill in all required fields",variant:"destructive"});return}try{const{error:t}=await g.from("ab_tests").insert({user_id:s.id,test_name:x,description:u,variant_a_prompt:l,variant_b_prompt:w,status:"active"});if(t)throw t;v({title:"Test created",description:"Your A/B test has been created successfully"}),o(!1),p(""),m(""),h(""),A(""),C()}catch(t){v({title:"Error creating test",description:t.message,variant:"destructive"})}},z=async(t,c)=>{try{const{error:d}=await g.from("ab_tests").update({status:c,completed_at:c==="completed"?new Date().toISOString():null}).eq("id",t);if(d)throw d;v({title:"Test updated",description:`Test ${c}`}),C()}catch(d){v({title:"Error updating test",description:d.message,variant:"destructive"})}},K=async t=>{const{data:c}=await g.from("ab_test_results").select("*").eq("test_id",t),d={a:{variant:"A",clicks:0,conversions:0,engagement:0},b:{variant:"B",clicks:0,conversions:0,engagement:0}};return c==null||c.forEach(f=>{const T=f.variant==="a"?d.a:d.b;f.metric_name==="clicks"&&(T.clicks=Number(f.metric_value)),f.metric_name==="conversions"&&(T.conversions=Number(f.metric_value)),f.metric_name==="engagement_time"&&(T.engagement=Number(f.metric_value))}),d};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"A/B Testing"}),e.jsx("p",{className:"text-muted-foreground",children:"Test prompt variations and optimize performance"})]}),e.jsxs(j,{onClick:()=>o(!a),children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"New Test"]})]}),a&&e.jsxs(_,{children:[e.jsxs(F,{children:[e.jsx(I,{children:"Create A/B Test"}),e.jsx(L,{children:"Set up a new test to compare two prompt variations"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"testName",children:"Test Name"}),e.jsx(P,{id:"testName",value:x,onChange:t=>p(t.target.value),placeholder:"E.g., Product Description Test"})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"description",children:"Description (Optional)"}),e.jsx(P,{id:"description",value:u,onChange:t=>m(t.target.value),placeholder:"What are you testing?"})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"variantA",children:"Variant A Prompt"}),e.jsx(B,{id:"variantA",value:l,onChange:t=>h(t.target.value),placeholder:"Enter first prompt variation...",rows:4})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"variantB",children:"Variant B Prompt"}),e.jsx(B,{id:"variantB",value:w,onChange:t=>A(t.target.value),placeholder:"Enter second prompt variation...",rows:4})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{onClick:V,children:"Create Test"}),e.jsx(j,{variant:"outline",onClick:()=>o(!1),children:"Cancel"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[i.map(t=>e.jsx(ee,{test:t,onUpdateStatus:z,getResults:K},t.id)),i.length===0&&!a&&e.jsx(_,{children:e.jsxs(S,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Y,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No A/B tests yet"}),e.jsxs(j,{onClick:()=>o(!0),children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Create Your First Test"]})]})})]})]})}function ee({test:s,onUpdateStatus:i,getResults:n}){const[a,o]=r.useState(null);r.useEffect(()=>{n(s.id).then(o)},[s.id]);const x=u=>{switch(u){case"active":return"text-green-500";case"paused":return"text-yellow-500";case"completed":return"text-blue-500";default:return"text-muted-foreground"}},p=a&&a.a.conversions>a.b.conversions?"A":"B";return e.jsxs(_,{children:[e.jsx(F,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(I,{children:s.test_name}),s.description&&e.jsx(L,{children:s.description})]}),e.jsx("span",{className:`text-sm font-medium ${x(s.status)}`,children:s.status.toUpperCase()})]})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Variant A"}),s.status==="completed"&&p==="A"&&e.jsx(k,{className:"h-4 w-4 text-green-500"})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:s.variant_a_prompt}),a&&e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Clicks:"}),e.jsx("span",{className:"font-medium",children:a.a.clicks})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Conversions:"}),e.jsx("span",{className:"font-medium",children:a.a.conversions})]}),e.jsx(E,{value:a.a.conversions/Math.max(a.a.clicks,1)*100,className:"h-2"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Variant B"}),s.status==="completed"&&p==="B"&&e.jsx(k,{className:"h-4 w-4 text-green-500"})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:s.variant_b_prompt}),a&&e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Clicks:"}),e.jsx("span",{className:"font-medium",children:a.b.clicks})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Conversions:"}),e.jsx("span",{className:"font-medium",children:a.b.conversions})]}),e.jsx(E,{value:a.b.conversions/Math.max(a.b.clicks,1)*100,className:"h-2"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.status==="active"&&e.jsxs(e.Fragment,{children:[e.jsxs(j,{size:"sm",variant:"outline",onClick:()=>i(s.id,"paused"),children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Pause"]}),e.jsxs(j,{size:"sm",variant:"outline",onClick:()=>i(s.id,"completed"),children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Complete"]})]}),s.status==="paused"&&e.jsxs(j,{size:"sm",variant:"outline",onClick:()=>i(s.id,"active"),children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Resume"]})]})]})]})}const we=()=>{const s=q(),[i]=U(),[n,a]=r.useState(null),[o,x]=r.useState(!0),[p,u]=r.useState(i.get("tab")||"profile");return r.useEffect(()=>{const{data:{subscription:m}}=g.auth.onAuthStateChange((l,h)=>{a((h==null?void 0:h.user)??null),h||s("/auth")});return g.auth.getSession().then(({data:{session:l}})=>{a((l==null?void 0:l.user)??null),l||s("/auth"),x(!1)}),()=>m.unsubscribe()},[s]),r.useEffect(()=>{const m=i.get("tab");if(m==="pricing"){s("/pricing");return}m&&u(m)},[i,s]),o?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-pulse-subtle",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin"})})}):e.jsx(G,{user:n,showHeader:!1,children:e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-b from-background via-background to-muted/20",children:e.jsxs("div",{className:"container-responsive mx-auto max-w-6xl py-8 sm:py-12 md:py-16 lg:py-20",children:[e.jsxs("div",{className:"mb-6 sm:mb-8 md:mb-10 lg:mb-12 space-y-2 sm:space-y-3 md:space-y-4",children:[e.jsx("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-foreground",children:"Settings"}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg lg:text-xl text-muted-foreground max-w-2xl leading-relaxed",children:"Manage your profile, API keys, SDK integration, and platform preferences"})]}),e.jsxs(J,{value:p,onValueChange:u,className:"w-full space-y-6 sm:space-y-8 md:space-y-10",children:[e.jsx("div",{className:"flex justify-center overflow-x-auto pb-2 -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(Q,{className:"inline-flex h-11 sm:h-12 md:h-14 items-center justify-center rounded-xl bg-muted/50 p-1.5 text-muted-foreground backdrop-blur-sm border border-border/50 shadow-lg",children:[e.jsx(N,{value:"profile",className:"px-3 sm:px-5 md:px-7 py-2 sm:py-2.5 md:py-3 rounded-lg text-sm sm:text-base font-semibold whitespace-nowrap",children:"Profile"}),e.jsx(N,{value:"apikeys",className:"px-3 sm:px-5 md:px-7 py-2 sm:py-2.5 md:py-3 rounded-lg text-sm sm:text-base font-semibold whitespace-nowrap",children:"API Keys"}),e.jsx(N,{value:"sdk",className:"px-3 sm:px-5 md:px-7 py-2 sm:py-2.5 md:py-3 rounded-lg text-sm sm:text-base font-semibold whitespace-nowrap",children:"SDK"}),e.jsx(N,{value:"abtesting",className:"px-3 sm:px-5 md:px-7 py-2 sm:py-2.5 md:py-3 rounded-lg text-sm sm:text-base font-semibold whitespace-nowrap",children:"A/B Testing"})]})}),e.jsx(y,{value:"profile",className:"mt-0 space-y-6",children:e.jsx(H,{userId:(n==null?void 0:n.id)||""})}),e.jsx(y,{value:"apikeys",className:"mt-0 space-y-6",children:e.jsx(O,{user:n})}),e.jsx(y,{value:"sdk",className:"mt-0 space-y-6",children:e.jsx(W,{})}),e.jsx(y,{value:"abtesting",className:"mt-0 space-y-6",children:e.jsx(Z,{user:n})})]})]})})})};export{we as default};
