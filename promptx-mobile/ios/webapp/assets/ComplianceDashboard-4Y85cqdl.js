import{c as P,r as u,x as R,j as e,h as l,i as n,k as d,m as o,T as v,l as M}from"./index-C2MjUc6j.js";import{B as p}from"./badge-BmD5Ofur.js";import{s as T}from"./index-z1pI4DUj.js";import{P as V}from"./progress-Dbp9893P.js";import{S as f}from"./shield-BU0WWken.js";import{L as q}from"./lock-DoPTFIOb.js";import{C as y}from"./circle-check-big-BtjQXCTU.js";import{C as A}from"./circle-x-BfMI6AYM.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=P("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);function W({user:N}){const[g,C]=u.useState([]),[c,k]=u.useState({totalChecks:0,passedChecks:0,avgScore:0,criticalViolations:0}),{toast:w}=R();u.useEffect(()=>{b()},[N]);const b=async()=>{try{const{data:s,error:r}=await T.from("prompt_compliance_checks").select("*").eq("user_id",N.id).order("checked_at",{ascending:!1}).limit(10);if(r)throw r;if(s&&s.length>0){C(s);const i=s.length,m=s.filter(t=>{const a=t.check_results;return(a==null?void 0:a.passed)===!0}).length,x=s.reduce((t,a)=>t+(a.compliance_score||0),0)/i,h=s.reduce((t,a)=>{const j=a.check_results,_=(j==null?void 0:j.violations)||[];return t+_.filter(D=>D.severity==="critical").length},0);k({totalChecks:i,passedChecks:m,avgScore:Math.round(x),criticalViolations:h})}}catch(s){w({title:"Error fetching compliance data",description:s.message,variant:"destructive"})}},S=s=>{switch(s){case"critical":return"destructive";case"high":return"destructive";case"medium":return"secondary";case"low":return"outline";default:return"outline"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(f,{className:"h-6 w-6 text-primary"}),"Compliance Dashboard"]}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor bias detection and compliance checks"})]}),e.jsxs(p,{variant:"outline",className:"text-sm",children:[e.jsx(q,{className:"mr-1 h-3 w-3"}),"SOC2 • GDPR • HIPAA Ready"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(l,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Total Checks"}),e.jsx(E,{className:"h-4 w-4 text-primary"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.totalChecks}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Prompts analyzed"})]})]}),e.jsxs(l,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Pass Rate"}),e.jsx(y,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[c.totalChecks>0?Math.round(c.passedChecks/c.totalChecks*100):0,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[c.passedChecks," passed checks"]})]})]}),e.jsxs(l,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Avg Score"}),e.jsx(f,{className:"h-4 w-4 text-primary"})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[c.avgScore,"/100"]}),e.jsx(V,{value:c.avgScore,className:"h-2 mt-2"})]})]}),e.jsxs(l,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Critical Issues"}),e.jsx(v,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.criticalViolations}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Requires immediate attention"})]})]})]}),e.jsxs(l,{children:[e.jsxs(n,{children:[e.jsx(d,{children:"Recent Compliance Checks"}),e.jsx(M,{children:"History of bias detection and compliance scans"})]}),e.jsx(o,{className:"space-y-4",children:g.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(f,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No compliance checks yet"}),e.jsx("p",{className:"text-sm",children:"Generate prompts with compliance checking enabled"})]}):g.map(s=>{var r,i,m,x,h;return e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-2",children:s.prompt_text}),e.jsxs("div",{className:"flex items-center gap-2",children:[(r=s.check_results)!=null&&r.passed?e.jsxs(p,{variant:"outline",className:"text-green-600",children:[e.jsx(y,{className:"mr-1 h-3 w-3"}),"Passed"]}):e.jsxs(p,{variant:"destructive",children:[e.jsx(A,{className:"mr-1 h-3 w-3"}),"Failed"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Score: ",s.compliance_score,"/100"]})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s.checked_at).toLocaleDateString()})]}),((m=(i=s.check_results)==null?void 0:i.violations)==null?void 0:m.length)>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Violations:"}),s.check_results.violations.map((t,a)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(p,{variant:S(t.severity),className:"text-xs",children:t.severity}),e.jsx("span",{className:"flex-1",children:t.description||t.rule})]},a))]}),((h=(x=s.check_results)==null?void 0:x.warnings)==null?void 0:h.length)>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Warnings:"}),s.check_results.warnings.map((t,a)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(v,{className:"h-4 w-4 mt-0.5"}),e.jsx("span",{className:"flex-1",children:t.description||t.filter})]},a))]})]},s.id)})})]})]})}export{W as C};
