import{c as Ce,r as l,x as Se,j as e,B as o,S as ke,h as $,m as H,i as Pe,k as Te,l as Fe,q as Ge,n as Qe}from"./index-C2MjUc6j.js";import{s as d}from"./index-z1pI4DUj.js";import{I as V}from"./index-C0NKCsYR.js";import{B as y}from"./badge-BmD5Ofur.js";import{D as J,f as Je,a as K,b as W,c as X,d as Z}from"./dialog-D-kFK5f8.js";import{L as g}from"./label-CPXGueWk.js";import{T as L}from"./textarea-BKVa-xUV.js";import{S as Ke}from"./slider-DOuiAmCR.js";import{S as ue,a as fe,b as je,c as ge,d as f}from"./select-JOWFLGTk.js";import{T as Ae,a as De,b as k,c as ee}from"./tabs-CyOF3ppl.js";import{A as ve,b as Ne}from"./avatar-DwxK4ALl.js";import{S as We}from"./SocialShare-Ds_WculW.js";import{S as D}from"./shopping-cart-C_zzwruH.js";import{P as Xe}from"./plus-XtvXWcDu.js";import{C as we}from"./crown-D3TlBkXs.js";import{F as ye}from"./flame-CCdSfuCi.js";import{C as A}from"./circle-check-big-BtjQXCTU.js";import{S as Ze}from"./search-D2kltBGq.js";import{S as se}from"./star-CvJAy4g_.js";import{H as te}from"./heart-CIoF1XdN.js";import{E as ae}from"./eye-IzXR7YU-.js";import{D as be}from"./download-HMPM07Ay.js";import{A as Le}from"./award-qGEdKRCw.js";import{L as es}from"./LegalPromptPacks-BWU43gwV.js";import{a as ss}from"./index-BOT--vBY.js";import{C as as}from"./code-DFXLlMDu.js";import{G as ts}from"./graduation-cap-oX6Hq-l0.js";import{i as rs,L as ls}from"./Layout-lstxxF2Q.js";import{D as is}from"./dollar-sign-DZ70S1lw.js";import"./index-BdQq_4o_.js";import"./index-CdTD_yct.js";import"./share-2-ceq3zW03.js";import"./send-Bprvxut_.js";import"./shield-BU0WWken.js";import"./globe-j_oUgXOC.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=Ce("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=Ce("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),cs=({user:c})=>{var oe,de,me;const[h,P]=l.useState([]),[v,E]=l.useState([]),[m,j]=l.useState(""),[u,z]=l.useState("all"),[b,B]=l.useState([0,500]),[S,r]=l.useState(0),[_,$e]=l.useState("newest"),[U,Ee]=l.useState(!1),[T,re]=l.useState(new Set),[Be,le]=l.useState(!1),[Me,M]=l.useState(!1),[Re,Y]=l.useState(!1),[a,ie]=l.useState(null),[R,ne]=l.useState("all"),{toast:p}=Se(),[i,C]=l.useState({title:"",description:"",prompt_content:"",preview_content:"",category:"marketing",price:0,tags:""});l.useEffect(()=>{O(),qe()},[]),l.useEffect(()=>{ze()},[h,m,u,b,S,_,R]);const O=async()=>{try{const{data:s,error:t}=await d.from("marketplace_listings").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(t)throw t;const n=[...new Set((s==null?void 0:s.map(x=>x.seller_id))||[])],{data:N}=await d.from("profiles").select("id, username, avatar_url").in("id",n),pe=(s==null?void 0:s.map(x=>x.id))||[],{data:G}=await d.from("prompt_ratings").select("prompt_id, rating").in("prompt_id",pe),{data:Q}=await d.from("prompt_purchases").select("listing_id").in("listing_id",pe);let xe=[];if(c){const{data:x}=await d.from("prompt_purchases").select("listing_id").eq("buyer_id",c.id);xe=x||[]}const Ye=(s==null?void 0:s.map(x=>{const F=N==null?void 0:N.find(w=>w.id===x.seller_id),I=(G==null?void 0:G.filter(w=>w.prompt_id===x.id))||[],he=I.length>0?I.reduce((w,Oe)=>w+Oe.rating,0)/I.length:0,q=(Q==null?void 0:Q.filter(w=>w.listing_id===x.id).length)||0;return{...x,seller_name:(F==null?void 0:F.username)||"Anonymous",seller_verified:q>10,seller_avatar:F==null?void 0:F.avatar_url,rating:Math.round(he*10)/10,review_count:I.length,downloads:q,purchased:xe.some(w=>w.listing_id===x.id),is_trending:q>5&&x.views>100,is_featured:q>20||he>=4.5,revenue:q*x.price}}))||[];P(Ye)}catch(s){console.error("Error loading listings:",s),p({title:"Error",description:"Failed to load marketplace listings",variant:"destructive"})}},qe=async()=>{if(c)try{const{data:s}=await d.from("user_activity").select("metadata").eq("user_id",c.id).eq("activity_type","favorite_listing"),t=(s==null?void 0:s.map(n=>{const N=n.metadata;return N==null?void 0:N.listing_id}).filter(Boolean))||[];re(new Set(t))}catch(s){console.error("Error loading favorites:",s)}},ze=()=>{let s=h;switch(R==="featured"?s=s.filter(t=>t.is_featured):R==="trending"?s=s.filter(t=>t.is_trending):R==="purchased"&&(s=s.filter(t=>t.purchased)),u!=="all"&&(s=s.filter(t=>t.category===u)),s=s.filter(t=>t.price>=b[0]&&t.price<=b[1]),S>0&&(s=s.filter(t=>(t.rating||0)>=S)),m&&(s=s.filter(t=>{var n;return t.title.toLowerCase().includes(m.toLowerCase())||t.description.toLowerCase().includes(m.toLowerCase())||t.tags.some(N=>N.toLowerCase().includes(m.toLowerCase()))||((n=t.seller_name)==null?void 0:n.toLowerCase().includes(m.toLowerCase()))})),_){case"newest":s.sort((t,n)=>new Date(n.created_at).getTime()-new Date(t.created_at).getTime());break;case"popular":s.sort((t,n)=>n.downloads+n.views-(t.downloads+t.views));break;case"rating":s.sort((t,n)=>(n.rating||0)-(t.rating||0));break;case"price-low":s.sort((t,n)=>t.price-n.price);break;case"price-high":s.sort((t,n)=>n.price-t.price);break}E(s)},ce=async s=>{if(!c){p({title:"Sign in required",description:"Please sign in to save favorites",variant:"destructive"});return}const t=new Set(T);T.has(s)?t.delete(s):(t.add(s),await d.from("user_activity").insert({user_id:c.id,activity_type:"favorite_listing",metadata:{listing_id:s}})),re(t),p({title:T.has(s)?"Removed from favorites":"Added to favorites"})},Ie=async()=>{if(!c){p({title:"Authentication required",description:"Please sign in to list prompts",variant:"destructive"});return}if(!i.title||!i.prompt_content){p({title:"Missing information",description:"Please fill in title and prompt content",variant:"destructive"});return}try{const{error:s}=await d.from("marketplace_listings").insert({seller_id:c.id,title:i.title,description:i.description,prompt_content:i.prompt_content,preview_content:i.preview_content,category:i.category,price:i.price,tags:i.tags.split(",").map(t=>t.trim()).filter(Boolean)});if(s)throw s;p({title:"Success!",description:"Your prompt is now listed in the marketplace"}),C({title:"",description:"",prompt_content:"",preview_content:"",category:"marketing",price:0,tags:""}),le(!1),O()}catch(s){p({title:"Error",description:s.message,variant:"destructive"})}},Ve=async s=>{if(!c){p({title:"Authentication required",description:"Please sign in to purchase",variant:"destructive"});return}if(s.seller_id===c.id){p({title:"Cannot purchase",description:"You cannot purchase your own listing",variant:"destructive"});return}try{const{error:t}=await d.from("prompt_purchases").insert({listing_id:s.id,buyer_id:c.id,price:s.price});if(t)throw t;await d.from("marketplace_listings").update({downloads:(s.downloads||0)+1}).eq("id",s.id),p({title:"Purchase successful!",description:"You can now access the full prompt"}),M(!1),O()}catch(t){p({title:"Purchase failed",description:t.message,variant:"destructive"})}},He=async s=>{const t=h.find(n=>n.id===s);t&&await d.from("marketplace_listings").update({views:(t.views||0)+1}).eq("id",s)},Ue=async s=>{try{await navigator.clipboard.writeText(s),p({title:"Copied!",description:"Prompt copied to clipboard"})}catch{p({title:"Failed to copy",description:"Please try again",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-primary/20 to-primary/5",children:e.jsx(D,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Marketplace"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[v.length," prompts â€¢ ",h.filter(s=>s.is_featured).length," featured â€¢ ",h.filter(s=>s.is_trending).length," trending"]})]})]}),c&&e.jsxs(J,{open:Be,onOpenChange:le,children:[e.jsx(Je,{asChild:!0,children:e.jsxs(o,{className:"gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"}),"List Your Prompt"]})}),e.jsxs(K,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(W,{children:[e.jsx(X,{children:"List Your Prompt"}),e.jsx(Z,{children:"Share your best prompts with the community and earn"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Title *"}),e.jsx(V,{value:i.title,onChange:s=>C({...i,title:s.target.value}),placeholder:"E.g., Advanced Marketing Campaign Generator"})]}),e.jsxs("div",{children:[e.jsx(g,{children:"Description *"}),e.jsx(L,{value:i.description,onChange:s=>C({...i,description:s.target.value}),placeholder:"Describe what makes your prompt unique and valuable...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Category *"}),e.jsxs(ue,{value:i.category,onValueChange:s=>C({...i,category:s}),children:[e.jsx(fe,{children:e.jsx(je,{})}),e.jsxs(ge,{children:[e.jsx(f,{value:"marketing",children:"Marketing"}),e.jsx(f,{value:"trading",children:"Trading"}),e.jsx(f,{value:"coding",children:"Coding"}),e.jsx(f,{value:"design",children:"Design"}),e.jsx(f,{value:"content",children:"Content"}),e.jsx(f,{value:"education",children:"Education"}),e.jsx(f,{value:"business",children:"Business"})]})]})]}),e.jsxs("div",{children:[e.jsx(g,{children:"Price (USD) *"}),e.jsx(V,{type:"number",min:"0",step:"0.01",value:i.price,onChange:s=>C({...i,price:parseFloat(s.target.value)||0}),placeholder:"9.99"})]})]}),e.jsxs("div",{children:[e.jsx(g,{children:"Tags (comma-separated)"}),e.jsx(V,{value:i.tags,onChange:s=>C({...i,tags:s.target.value}),placeholder:"marketing, social media, conversion"})]}),e.jsxs("div",{children:[e.jsx(g,{children:"Preview Content"}),e.jsx(L,{value:i.preview_content,onChange:s=>C({...i,preview_content:s.target.value}),placeholder:"A short preview that buyers can see before purchasing...",rows:2})]}),e.jsxs("div",{children:[e.jsx(g,{children:"Full Prompt Content *"}),e.jsx(L,{value:i.prompt_content,onChange:s=>C({...i,prompt_content:s.target.value}),placeholder:"Your complete prompt (only visible after purchase)...",rows:6})]}),e.jsx(o,{onClick:Ie,className:"w-full",size:"lg",children:"Create Listing"})]})]})]})]}),e.jsx(Ae,{value:R,onValueChange:ne,className:"w-full",children:e.jsxs(De,{className:"w-full max-w-2xl bg-muted/50",children:[e.jsxs(k,{value:"all",className:"flex-1 gap-2",children:[e.jsx(ke,{className:"h-4 w-4"}),"All Prompts"]}),e.jsxs(k,{value:"featured",className:"flex-1 gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Featured"]}),e.jsxs(k,{value:"trending",className:"flex-1 gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Trending"]}),c&&e.jsxs(k,{value:"purchased",className:"flex-1 gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Purchased"]})]})}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(V,{placeholder:"Search prompts, sellers, tags...",value:m,onChange:s=>j(s.target.value),className:"pl-10"})]}),e.jsxs(ue,{value:_,onValueChange:$e,children:[e.jsx(fe,{className:"w-full sm:w-[180px]",children:e.jsx(je,{placeholder:"Sort by"})}),e.jsxs(ge,{children:[e.jsx(f,{value:"newest",children:"Newest"}),e.jsx(f,{value:"popular",children:"Most Popular"}),e.jsx(f,{value:"rating",children:"Highest Rated"}),e.jsx(f,{value:"price-low",children:"Price: Low to High"}),e.jsx(f,{value:"price-high",children:"Price: High to Low"})]})]}),e.jsxs(o,{variant:U?"default":"outline",onClick:()=>Ee(!U),className:"gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),"Filters"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","marketing","trading","coding","design","content","education","business"].map(s=>e.jsx(o,{variant:u===s?"default":"outline",size:"sm",onClick:()=>z(s),className:"rounded-full",children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),U&&e.jsxs($,{className:"p-4 space-y-4 bg-muted/30",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{className:"flex items-center justify-between",children:e.jsxs("span",{children:["Price Range: $",b[0]," - $",b[1]]})}),e.jsx(Ke,{value:b,onValueChange:s=>B(s),min:0,max:500,step:10,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Minimum Rating"}),e.jsx("div",{className:"flex gap-1",children:[0,1,2,3,4,5].map(s=>e.jsxs(o,{variant:S===s?"default":"outline",size:"sm",onClick:()=>r(s),className:"gap-1",children:[e.jsx(se,{className:`h-3 w-3 ${s<=S?"fill-current":""}`}),s>0&&`${s}+`,s===0&&"All"]},s))})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.length===0?e.jsx($,{className:"col-span-full",children:e.jsxs(H,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(D,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No prompts found matching your criteria"}),e.jsx(o,{variant:"outline",className:"mt-4",onClick:()=>{j(""),z("all"),B([0,500]),r(0),ne("all")},children:"Clear Filters"})]})}):v.map(s=>{var t;return e.jsxs($,{className:"group hover:shadow-xl transition-all duration-300 hover:border-primary/50 relative overflow-hidden",children:[s.is_featured&&e.jsx("div",{className:"absolute top-2 left-2 z-10",children:e.jsxs(y,{className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white gap-1",children:[e.jsx(we,{className:"h-3 w-3"}),"Featured"]})}),s.is_trending&&e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsxs(y,{className:"bg-gradient-to-r from-red-500 to-pink-500 text-white gap-1",children:[e.jsx(ye,{className:"h-3 w-3"}),"Trending"]})}),e.jsxs(Pe,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 pt-8",children:[e.jsx(Te,{className:"text-lg line-clamp-2 group-hover:text-primary transition-colors",children:s.title}),e.jsx(o,{variant:"ghost",size:"icon",className:"shrink-0",onClick:()=>ce(s.id),children:e.jsx(te,{className:`h-5 w-5 ${T.has(s.id)?"fill-red-500 text-red-500":""}`})})]}),e.jsx(Fe,{className:"line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-6 w-6",children:e.jsx(Ne,{className:"text-xs",children:(t=s.seller_name)==null?void 0:t.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[s.seller_name,s.seller_verified&&e.jsx(A,{className:"h-3 w-3 text-blue-500"})]})]})]}),e.jsxs(H,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[s.tags.slice(0,4).map(n=>e.jsx(y,{variant:"secondary",className:"text-xs rounded-full",children:n},n)),s.tags.length>4&&e.jsxs(y,{variant:"outline",className:"text-xs rounded-full",children:["+",s.tags.length-4]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ae,{className:"h-3.5 w-3.5"}),s.views]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"h-3.5 w-3.5"}),s.downloads]})]}),s.rating&&s.rating>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-medium",children:s.rating.toFixed(1)}),e.jsxs("span",{className:"text-muted-foreground",children:["(",s.review_count,")"]})]})]}),e.jsxs("div",{className:"pt-3 border-t space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-2xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:["$",s.price]}),e.jsx(y,{variant:"outline",className:"text-xs",children:s.category})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>{ie(s),Y(!0)},className:"gap-1",children:[e.jsx(ae,{className:"h-3.5 w-3.5"}),"Preview"]}),e.jsx(o,{size:"sm",onClick:()=>{He(s.id),ie(s),M(!0)},disabled:s.purchased,className:"gap-1",children:s.purchased?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-3.5 w-3.5"}),"Owned"]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"h-3.5 w-3.5"}),"Buy Now"]})})]})]})]})]},s.id)})}),e.jsx(J,{open:Re,onOpenChange:Y,children:e.jsxs(K,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{className:"text-2xl",children:a==null?void 0:a.title}),e.jsx(Z,{children:a==null?void 0:a.description})]}),e.jsx(y,{variant:"secondary",children:a==null?void 0:a.category})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{children:e.jsx(Ne,{children:(oe=a==null?void 0:a.seller_name)==null?void 0:oe.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium flex items-center gap-1",children:[a==null?void 0:a.seller_name,(a==null?void 0:a.seller_verified)&&e.jsx(A,{className:"h-4 w-4 text-blue-500"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Verified Seller"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:["$",a==null?void 0:a.price]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a==null?void 0:a.downloads," sales"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Prompt Preview"}),e.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:(a==null?void 0:a.preview_content)||((de=a==null?void 0:a.prompt_content)==null?void 0:de.substring(0,200))+"..."})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Full prompt available after purchase"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a==null?void 0:a.tags.map(s=>e.jsx(y,{variant:"outline",children:s},s))}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"h-5 w-5 mx-auto mb-1 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium",children:a==null?void 0:a.views}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Views"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(be,{className:"h-5 w-5 mx-auto mb-1 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium",children:a==null?void 0:a.downloads}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sales"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(se,{className:"h-5 w-5 mx-auto mb-1 text-yellow-400 fill-yellow-400"}),e.jsx("p",{className:"text-sm font-medium",children:((me=a==null?void 0:a.rating)==null?void 0:me.toFixed(1))||"N/A"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Rating"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(Le,{className:"h-5 w-5 mx-auto mb-1 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium",children:(a==null?void 0:a.review_count)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Reviews"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(o,{variant:"outline",className:"flex-1 gap-2",onClick:()=>ce((a==null?void 0:a.id)||""),children:[e.jsx(te,{className:`h-4 w-4 ${T.has((a==null?void 0:a.id)||"")?"fill-red-500 text-red-500":""}`}),T.has((a==null?void 0:a.id)||"")?"Saved":"Save"]}),e.jsxs(o,{className:"flex-1 gap-2",onClick:()=>{Y(!1),M(!0)},disabled:a==null?void 0:a.purchased,children:[e.jsx(D,{className:"h-4 w-4"}),a!=null&&a.purchased?"Already Owned":`Buy for $${a==null?void 0:a.price}`]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx(We,{title:`Check out "${a==null?void 0:a.title}" on Prompt Marketplace`,description:`${a==null?void 0:a.description} - Only $${a==null?void 0:a.price}!`})})]})]})}),e.jsx(J,{open:Me,onOpenChange:M,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsxs(W,{children:[e.jsx(X,{children:"Purchase Prompt"}),e.jsxs(Z,{children:[`You're about to purchase "`,a==null?void 0:a.title,'"']})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsx($,{className:"p-4 bg-muted/30",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Prompt"}),e.jsx("span",{className:"font-medium",children:a.title})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Seller"}),e.jsxs("span",{className:"font-medium flex items-center gap-1",children:[a.seller_name,a.seller_verified&&e.jsx(A,{className:"h-3 w-3 text-blue-500"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-lg font-medium",children:"Total"}),e.jsxs("span",{className:"text-2xl font-bold text-primary",children:["$",a.price]})]})]})}),a.purchased?e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-950/20 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsxs("p",{className:"text-sm text-green-800 dark:text-green-200 mb-3",children:[e.jsx(A,{className:"inline h-4 w-4 mr-2"}),"You own this prompt! Here's the full content:"]}),e.jsx("div",{className:"p-3 bg-background rounded border",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap font-mono",children:a.prompt_content})}),e.jsxs(o,{variant:"outline",size:"sm",className:"mt-3 gap-2",onClick:()=>Ue(a.prompt_content),children:[e.jsx(Ge,{className:"h-3.5 w-3.5"}),"Copy Prompt"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"ðŸ’¡ After purchase, you'll have lifetime access to this prompt and can use it unlimited times."})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(o,{variant:"outline",className:"flex-1",onClick:()=>M(!1),children:"Cancel"}),e.jsxs(o,{className:"flex-1 gap-2",onClick:()=>Ve(a),children:[e.jsx(D,{className:"h-4 w-4"}),"Confirm Purchase $",a.price]})]})]})]})]})})]})},os={trading:ss,marketing:ke,coding:as,healthcare:te,education:ts,"e-commerce":D,legal:rs,finance:is},ds=({onTemplateSelect:c})=>{const[h,P]=l.useState([]),[v,E]=l.useState("all"),[m,j]=l.useState(!1),{toast:u}=Se();l.useEffect(()=>{z()},[]);const z=async()=>{j(!0);try{const{data:r,error:_}=await d.from("industry_templates").select("*").order("industry",{ascending:!0});if(_)throw _;P(r||[])}catch(r){console.error("Error loading templates:",r),u({title:"Error Loading Templates",description:r.message,variant:"destructive"})}finally{j(!1)}},b=["all",...Array.from(new Set(h.map(r=>r.industry)))],B=v==="all"?h:h.filter(r=>r.industry===v),S=r=>{c(r.template_prompt),u({title:"âœ¨ Template Applied!",description:`Using ${r.template_name} template`})};return e.jsxs($,{className:"bg-gradient-to-br from-background to-secondary/5 border-primary/20",children:[e.jsxs(Pe,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5 text-primary"}),e.jsx(Te,{children:"Industry Templates"})]}),e.jsx(Fe,{children:"Pre-built prompt templates optimized for specific industries"})]}),e.jsx(H,{children:m?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"Loading templates..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:b.map(r=>e.jsx(o,{variant:v===r?"default":"outline",size:"sm",onClick:()=>E(r),children:r==="all"?"All":r.charAt(0).toUpperCase()+r.slice(1)},r))}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2",children:B.map(r=>{const _=os[r.industry]||_e;return e.jsx($,{className:"cursor-pointer hover:border-primary/50 transition-all hover:shadow-md",onClick:()=>S(r),children:e.jsx(H,{className:"p-4",children:e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(_,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-sm mb-1",children:r.template_name}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:r.description}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"secondary",className:"text-xs",children:r.industry}),e.jsx(y,{variant:"outline",className:"text-xs",children:r.platform})]})]})]})})})},r.id)})}),B.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No templates found for this industry"})]})})]})},Gs=()=>{const c=Qe(),[h,P]=l.useState(null),[v,E]=l.useState(!0);return l.useEffect(()=>{const{data:{subscription:m}}=d.auth.onAuthStateChange((j,u)=>{P((u==null?void 0:u.user)??null),u||c("/auth")});return d.auth.getSession().then(({data:{session:j}})=>{P((j==null?void 0:j.user)??null),j||c("/auth"),E(!1)}),()=>m.unsubscribe()},[c]),v?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-pulse-subtle",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin"})})}):e.jsx(ls,{user:h,showHeader:!1,children:e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-b from-background via-background to-muted/20",children:e.jsxs("div",{className:"container-responsive mx-auto max-w-6xl py-8 sm:py-12 md:py-16 lg:py-20",children:[e.jsxs("div",{className:"mb-6 sm:mb-8 md:mb-10 lg:mb-12 space-y-2 sm:space-y-3 md:space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold bg-gradient-to-r from-foreground to-foreground/70 bg-clip-text text-transparent leading-tight",children:"Prompt Marketplace"}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg lg:text-xl text-muted-foreground max-w-2xl leading-relaxed",children:"Discover, share, and purchase professional prompt templates and industry-specific packs"})]}),e.jsxs(Ae,{defaultValue:"marketplace",className:"w-full space-y-6 sm:space-y-8 md:space-y-10",children:[e.jsx("div",{className:"flex justify-center overflow-x-auto pb-2 -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(De,{className:"inline-flex h-11 sm:h-12 md:h-14 items-center justify-center rounded-xl bg-muted/50 p-1.5 text-muted-foreground backdrop-blur-sm border border-border/50 shadow-lg",children:[e.jsx(k,{value:"marketplace",className:"px-3 sm:px-5 md:px-7 py-2 sm:py-2.5 md:py-3 rounded-lg text-sm sm:text-base font-semibold whitespace-nowrap",children:"Marketplace"}),e.jsx(k,{value:"templates",className:"px-3 sm:px-5 md:px-7 py-2 sm:py-2.5 md:py-3 rounded-lg text-sm sm:text-base font-semibold whitespace-nowrap",children:"Templates"}),e.jsx(k,{value:"legal",className:"px-3 sm:px-5 md:px-7 py-2 sm:py-2.5 md:py-3 rounded-lg text-sm sm:text-base font-semibold whitespace-nowrap",children:"Legal Packs"})]})}),e.jsx(ee,{value:"marketplace",className:"mt-0 space-y-6",children:e.jsx(cs,{user:h})}),e.jsx(ee,{value:"templates",className:"mt-0 space-y-6",children:e.jsx(ds,{onTemplateSelect:m=>console.log(m)})}),e.jsx(ee,{value:"legal",className:"mt-0 space-y-6",children:e.jsx(es,{})})]})]})})})};export{Gs as default};
