import{c as oe,r as n,j as e,h as l,i as m,k as x,l as f,B as L,m as p,o as $,S as D,x as de,L as pe,n as he}from"./index-C2MjUc6j.js";import{s as N}from"./index-z1pI4DUj.js";import{T as ue}from"./textarea-BKVa-xUV.js";import{B as i}from"./badge-BmD5Ofur.js";import{P as U}from"./progress-Dbp9893P.js";import{T as Y,a as Z,b as k,c as C}from"./tabs-CyOF3ppl.js";import{S as J}from"./scroll-area-BY2TyNKv.js";import{G as Q}from"./globe-j_oUgXOC.js";import{a as K,b as G,Z as me,U as X}from"./index-BOT--vBY.js";import{L as B}from"./lightbulb-CBIcjJ48.js";import{C as je}from"./circle-alert-Bo2AORMt.js";import{B as M}from"./brain-BD0erMMT.js";import{N as O}from"./network-CGFe43Tq.js";import{G as ee}from"./git-branch-9MzCmu0-.js";import{E as xe}from"./eye-IzXR7YU-.js";import{S as ge}from"./share-2-ceq3zW03.js";import{L as H}from"./label-CPXGueWk.js";import{S as se,a as te,b as ae,c as re,d as E}from"./select-JOWFLGTk.js";import{g as ie,L as fe}from"./Layout-lstxxF2Q.js";import{A as le}from"./award-qGEdKRCw.js";import{D as ne}from"./dollar-sign-DZ70S1lw.js";import{T as Ne}from"./thumbs-up-Db_nuW_1.js";import"./index-C0NKCsYR.js";import"./index-BdQq_4o_.js";import"./index-CdTD_yct.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=oe("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=oe("MousePointerClick",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]]),ye=()=>{const[h,u]=n.useState([]),[y,b]=n.useState([]),[w,S]=n.useState([]),[v,_]=n.useState(!0),[P,r]=n.useState(!1),T=async()=>{try{const[s,c,t]=await Promise.all([N.from("global_prompt_patterns").select("*").order("success_rate",{ascending:!1}).limit(10),N.from("global_insights").select("*").order("confidence_score",{ascending:!1}).limit(10),N.from("global_topic_trends").select("*").order("popularity_score",{ascending:!1}).limit(10)]);s.data&&u(s.data),c.data&&b(c.data),t.data&&S(t.data)}catch(s){console.error("Error fetching global data:",s),$.error("Failed to load global insights")}finally{_(!1)}},j=async()=>{r(!0);try{const{error:s}=await N.functions.invoke("aggregate-global-insights");if(s)throw s;$.success("Global insights refreshed successfully"),await T()}catch(s){console.error("Error refreshing insights:",s),$.error("Failed to refresh insights")}finally{r(!1)}};if(n.useEffect(()=>{T()},[]),v)return e.jsx(l,{children:e.jsxs(m,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-primary animate-pulse"}),e.jsx(x,{children:"Prompt Intelligence Cloud"})]}),e.jsx(f,{children:"Loading global insights..."})]})});const I=s=>{switch(s){case"trend":return e.jsx(K,{className:"h-4 w-4"});case"best_practice":return e.jsx(B,{className:"h-4 w-4"});case"warning":return e.jsx(je,{className:"h-4 w-4"});case"opportunity":return e.jsx(D,{className:"h-4 w-4"});default:return e.jsx(B,{className:"h-4 w-4"})}},R=s=>{switch(s){case"rising":return"text-green-600";case"declining":return"text-red-600";default:return"text-yellow-600"}};return e.jsxs(l,{className:"w-full",children:[e.jsxs(m,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-primary"}),e.jsx(x,{children:"Prompt Intelligence Cloud"})]}),e.jsx(L,{size:"sm",variant:"outline",onClick:j,disabled:P,children:P?"Refreshing...":"Refresh Insights"})]}),e.jsx(f,{children:"Anonymized insights from successful prompts across the community"})]}),e.jsx(p,{children:e.jsxs(Y,{defaultValue:"patterns",className:"w-full",children:[e.jsxs(Z,{className:"grid w-full grid-cols-3",children:[e.jsxs(k,{value:"patterns",children:["Patterns (",h.length,")"]}),e.jsxs(k,{value:"insights",children:["Insights (",y.length,")"]}),e.jsxs(k,{value:"trends",children:["Trends (",w.length,")"]})]}),e.jsx(C,{value:"patterns",className:"space-y-4 mt-4",children:h.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No patterns available yet. Be the first to contribute!"}):h.map(s=>e.jsxs(l,{children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(x,{className:"text-base",children:s.pattern_name}),e.jsx(f,{className:"mt-1",children:s.pattern_description})]}),e.jsx(i,{variant:"secondary",children:s.pattern_type})]})}),e.jsxs(p,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Success Rate:"}),e.jsxs(i,{variant:"outline",children:[(s.success_rate*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Used by:"}),e.jsxs(i,{variant:"outline",children:[s.usage_count," users"]})]}),s.avg_improvement>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Improvement:"}),e.jsxs(i,{variant:"outline",className:"text-green-600",children:["+",s.avg_improvement.toFixed(1),"%"]})]})]}),e.jsx(U,{value:s.success_rate*100,className:"h-2"}),s.category&&s.platform&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"outline",children:s.category}),e.jsx(i,{variant:"outline",children:s.platform})]})]})]},s.id))}),e.jsx(C,{value:"insights",className:"space-y-4 mt-4",children:y.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No insights available yet. Check back soon!"}):y.map(s=>e.jsxs(l,{children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-primary/10 text-primary",children:I(s.insight_type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(x,{className:"text-base",children:s.title}),e.jsx(i,{variant:"secondary",children:s.insight_type})]}),e.jsx(f,{children:s.description})]})]})}),e.jsxs(p,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Confidence:"}),e.jsxs(i,{variant:"outline",children:[(s.confidence_score*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Impact:"}),e.jsxs(i,{variant:"outline",children:[(s.impact_score*100).toFixed(0),"%"]})]})]}),s.category&&s.platform&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"outline",children:s.category}),e.jsx(i,{variant:"outline",children:s.platform})]})]})]},s.id))}),e.jsx(C,{value:"trends",className:"space-y-4 mt-4",children:w.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No trends detected yet. Keep creating prompts!"}):w.map(s=>e.jsxs(l,{children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(x,{className:"text-base",children:s.topic_name}),e.jsxs(f,{className:"mt-1 flex items-center gap-2",children:[e.jsx(K,{className:`h-4 w-4 ${R(s.trend_direction)}`}),e.jsx("span",{className:R(s.trend_direction),children:s.trend_direction})]})]}),e.jsx(i,{variant:"secondary",children:s.category})]})}),e.jsxs(p,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Popularity:"}),e.jsxs(i,{variant:"outline",children:[s.popularity_score,"/100"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Growth:"}),e.jsxs(i,{variant:"outline",className:s.growth_rate>0?"text-green-600":"text-red-600",children:[s.growth_rate>0?"+":"",s.growth_rate.toFixed(1),"%"]})]})]}),e.jsx(U,{value:s.popularity_score,className:"h-2"}),s.related_topics.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Related:"}),s.related_topics.map((c,t)=>e.jsx(i,{variant:"outline",className:"text-xs",children:c},t))]}),s.platform&&e.jsx(i,{variant:"outline",children:s.platform})]})]},s.id))})]})})]})},be=({userId:h})=>{const[u,y]=n.useState([]),[b,w]=n.useState([]),[S,v]=n.useState([]),[_,P]=n.useState([]),[r,T]=n.useState(!0),[j,I]=n.useState(null);de(),n.useEffect(()=>{R()},[h]);const R=async()=>{T(!0);try{const{data:t,error:g}=await N.from("prompt_nodes").select("*").eq("user_id",h).order("created_at",{ascending:!1});if(g?(console.error("Error fetching nodes:",g),y([])):y(t||[]),t&&t.length>0){const q=t.map(o=>o.id),{data:V,error:a}=await N.from("prompt_relationships").select("*").in("source_prompt_id",q);a?(console.error("Error fetching relationships:",a),w([])):w(V||[])}const{data:d,error:z}=await N.from("prompt_topics").select("*").eq("user_id",h).order("prompt_count",{ascending:!1});z?(console.error("Error fetching topics:",z),v([])):v(d||[]);const{data:F,error:A}=await N.from("prompt_network_insights").select("*").eq("user_id",h).order("created_at",{ascending:!1}).limit(10);A?(console.error("Error fetching insights:",A),P([])):P(F||[])}catch(t){console.error("Error fetching graph data:",t),y([]),w([]),v([]),P([])}finally{T(!1)}},s=t=>{switch(t){case"derived_from":return e.jsx(ee,{className:"w-4 h-4"});case"similar_to":return e.jsx(ve,{className:"w-4 h-4"});case"inspired_by":return e.jsx(D,{className:"w-4 h-4"});case"prerequisite_for":return e.jsx(G,{className:"w-4 h-4"});case"alternative_to":return e.jsx(ge,{className:"w-4 h-4"});default:return e.jsx(O,{className:"w-4 h-4"})}},c=t=>b.filter(d=>d.source_prompt_id===t||d.target_prompt_id===t).map(d=>{const z=d.source_prompt_id===t?d.target_prompt_id:d.source_prompt_id;return{...u.find(F=>F.id===z),relationship:d}}).filter(d=>d.id);return r?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"animate-pulse-subtle",children:e.jsx(M,{className:"w-12 h-12 text-primary animate-pulse"})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(ye,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(O,{className:"w-8 h-8 text-primary"}),"Your Personal Knowledge Graph"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Semantic connections between your prompts"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(l,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:u.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Prompts"})]}),e.jsxs(l,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:b.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Connections"})]}),e.jsxs(l,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:S.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Topics"})]})]})]}),u.length===0?e.jsx(l,{className:"border-dashed",children:e.jsxs(p,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(O,{className:"w-16 h-16 text-muted-foreground mb-4 opacity-50"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No prompt data yet"}),e.jsx("p",{className:"text-muted-foreground text-center mb-6 max-w-md",children:"Use the Optimization Lab to create and optimize prompts. Your prompt network will grow as you use the platform."})]})}):e.jsxs(Y,{defaultValue:"graph",className:"space-y-6",children:[e.jsxs(Z,{className:"grid w-full grid-cols-4",children:[e.jsxs(k,{value:"graph",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Graph View"]}),e.jsxs(k,{value:"topics",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Topics"]}),e.jsxs(k,{value:"insights",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Insights"]}),e.jsxs(k,{value:"relationships",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Relationships"]})]}),e.jsx(C,{value:"graph",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(l,{children:[e.jsxs(m,{children:[e.jsx(x,{children:"Prompt Nodes"}),e.jsx(f,{children:"Click to view connections"})]}),e.jsx(p,{children:e.jsx(J,{className:"h-[600px]",children:e.jsx("div",{className:"space-y-2",children:u.map(t=>{var g;return e.jsxs("div",{onClick:()=>I(t),className:`p-4 border rounded-lg cursor-pointer transition-all ${(j==null?void 0:j.id)===t.id?"border-primary bg-primary/5":"hover:border-primary/50"}`,children:[e.jsx("p",{className:"text-sm font-medium line-clamp-2",children:t.prompt_text}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[t.category&&e.jsx(i,{variant:"secondary",className:"text-xs",children:t.category}),(g=t.keywords)==null?void 0:g.slice(0,2).map((d,z)=>e.jsx(i,{variant:"outline",className:"text-xs",children:d},z))]})]},t.id)})})})})]}),e.jsxs(l,{children:[e.jsxs(m,{children:[e.jsx(x,{children:j?"Connected Prompts":"Select a Node"}),e.jsx(f,{children:j?"Exploring relationships for selected prompt":"Click a prompt to view its connections"})]}),e.jsx(p,{children:j?e.jsx(J,{className:"h-[600px]",children:e.jsx("div",{className:"space-y-4",children:c(j.id).map(t=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[s(t.relationship.relationship_type),e.jsxs("div",{className:"flex-1",children:[e.jsx(i,{variant:"outline",className:"mb-2",children:t.relationship.relationship_type.replace("_"," ")}),e.jsx("p",{className:"text-sm line-clamp-3",children:t.prompt_text})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"flex-1 bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full",style:{width:`${t.relationship.strength*100}%`}})}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Math.round(t.relationship.strength*100),"% match"]})]})]},t.id))})}):e.jsx("div",{className:"flex items-center justify-center h-[600px] text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-4 opacity-20"}),e.jsx("p",{children:"Select a prompt to view connections"})]})})})]})]})}),e.jsx(C,{value:"topics",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:S.map(t=>e.jsxs(l,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-primary"}),t.topic_name]}),e.jsx(f,{children:t.description})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.prompt_count}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"prompts"})]})]},t.id))})}),e.jsx(C,{value:"insights",className:"space-y-4",children:_.map(t=>e.jsxs(l,{className:"border-l-4 border-l-primary",children:[e.jsxs(m,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-primary"}),t.title]}),e.jsxs(i,{variant:t.confidence_score>.7?"default":"secondary",children:[Math.round(t.confidence_score*100),"% confidence"]})]}),e.jsx(f,{children:t.insight_type})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm",children:t.description}),t.actionable_suggestion&&e.jsx("div",{className:"p-3 bg-primary/5 rounded-lg border border-primary/20",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-primary mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Action Suggestion"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.actionable_suggestion})]})]})})]})]},t.id))}),e.jsx(C,{value:"relationships",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(m,{children:[e.jsx(x,{children:"Relationship Types"}),e.jsx(f,{children:"Distribution of connections in your prompt network"})]}),e.jsx(p,{children:e.jsx("div",{className:"space-y-4",children:["derived_from","similar_to","inspired_by","prerequisite_for","alternative_to"].map(t=>{const g=b.filter(z=>z.relationship_type===t).length,d=b.length>0?g/b.length*100:0;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s(t),e.jsx("span",{className:"text-sm font-medium capitalize",children:t.replace("_"," ")})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[g," (",Math.round(d),"%)"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${d}%`}})})]},t)})})})]})})]})]})},we=({userId:h})=>{const[u,y]=n.useState(""),[b,w]=n.useState("engagement"),[S,v]=n.useState("social-media"),[_,P]=n.useState(!1),[r,T]=n.useState(null),[j,I]=n.useState([]),[R,s]=n.useState(null),[c,t]=n.useState({impressions:0,clicks:0,conversions:0,engagement:0}),{toast:g}=de();n.useEffect(()=>{d()},[]);const d=async()=>{try{const{data:a,error:o}=await N.from("prompt_feedback").select("*").eq("user_id",h).order("created_at",{ascending:!1}).limit(10);o?(console.error("Error fetching feedback history:",o),I([])):a&&I(a)}catch(a){console.error("Error in fetchFeedbackHistory:",a),I([])}},z=async()=>{if(!u.trim()){g({title:"Error",description:"Please enter a prompt to optimize",variant:"destructive"});return}try{const{data:a,error:o}=await N.rpc("check_usage_limit",{_user_id:h,_resource_type:"prompt_optimization",_period_days:30});if(o)throw o;if(!a.has_access&&!a.is_admin){g({title:"Prompt Limit Reached",description:`You've used ${a.used}/${a.limit} prompts. Upgrade to continue!`,variant:"destructive"}),setTimeout(()=>{window.location.href="/settings?tab=pricing"},2e3);return}}catch(a){console.error("Error checking usage limits:",a),g({title:"Error",description:"Failed to check usage limits. Please try again.",variant:"destructive"});return}P(!0),T(null);try{const a=await N.functions.invoke("execute-claude",{body:{prompt:`Optimize this prompt for ${b} on ${S}:

${u}

Provide detailed analysis, improvements, and expected impact.`,model:"claude-sonnet-4-5",temperature:.7,maxTokens:4e3}});if(a.error)throw a.error;const o={optimizedPrompt:a.data.result,improvements:["Optimized for clarity","Enhanced engagement potential","Improved call-to-action"],expectedImpact:{ctr:"+15-25%",engagement:"+20-30%",conversion:"+10-20%"},appliedPatterns:["power words","clear CTA","emotional triggers"],reasoning:"Applied proven optimization techniques based on platform and goal",learningContext:{totalExamples:j.length,avgRating:"4.2",patternsApplied:3}};T(o),await N.rpc("track_usage",{_user_id:h,_resource_type:"prompt_optimization",_count:1}),g({title:"Optimization Complete! ðŸŽ¯",description:"Optimized with Claude 4 Sonnet"}),d()}catch(a){console.error("Optimization error:",a),g({title:"Error",description:a.message||"Failed to optimize prompt",variant:"destructive"})}finally{P(!1)}},F=async a=>{if(r)try{const{error:o}=await N.from("prompt_feedback").insert({user_id:h,original_prompt:u,optimized_prompt:r.optimizedPrompt,rating:a,feedback_type:"manual",ctr:c.clicks>0?c.clicks/c.impressions*100:null,engagement_score:c.engagement,conversion_rate:c.conversions>0?c.conversions/c.clicks*100:null,shares_count:0,likes_count:0});if(o)throw o;g({title:"Feedback Submitted! ðŸŽ‰",description:"Your feedback helps improve future optimizations"}),d()}catch{g({title:"Error",description:"Failed to submit feedback",variant:"destructive"})}},A=(a,o)=>{t(W=>({...W,[a]:W[a]+o}))},q=c.impressions>0?(c.clicks/c.impressions*100).toFixed(2):0,V=c.clicks>0?(c.conversions/c.clicks*100).toFixed(2):0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(M,{className:"w-8 h-8 text-primary"}),"Prompt Optimization Lab"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"AI learns from feedback to continuously improve your prompts"})]}),j.length>0&&e.jsxs(i,{variant:"secondary",className:"text-sm",children:[e.jsx(K,{className:"w-3 h-3 mr-1"}),j.length," examples learned"]})]}),e.jsxs(Y,{defaultValue:"optimize",className:"space-y-6",children:[e.jsxs(Z,{className:"grid w-full grid-cols-4",children:[e.jsxs(k,{value:"optimize",children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Optimize"]}),e.jsxs(k,{value:"analytics",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Analytics"]}),e.jsxs(k,{value:"insights",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Insights"]}),e.jsxs(k,{value:"graph",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Knowledge Graph"]})]}),e.jsxs(C,{value:"optimize",className:"space-y-6",children:[e.jsxs(l,{children:[e.jsxs(m,{children:[e.jsx(x,{children:"Input Prompt"}),e.jsx(f,{children:"Enter your prompt and let AI optimize it based on learned patterns"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:"Original Prompt"}),e.jsx(ue,{value:u,onChange:a=>y(a.target.value),placeholder:"Enter the prompt you want to optimize...",rows:4,className:"resize-none"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:"Optimization Goal"}),e.jsxs(se,{value:b,onValueChange:w,children:[e.jsx(te,{children:e.jsx(ae,{})}),e.jsxs(re,{children:[e.jsx(E,{value:"engagement",children:"Engagement"}),e.jsx(E,{value:"conversion",children:"Conversion"}),e.jsx(E,{value:"ctr",children:"Click-Through Rate"}),e.jsx(E,{value:"awareness",children:"Brand Awareness"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:"Platform"}),e.jsxs(se,{value:S,onValueChange:v,children:[e.jsx(te,{children:e.jsx(ae,{})}),e.jsxs(re,{children:[e.jsx(E,{value:"social-media",children:"Social Media"}),e.jsx(E,{value:"email",children:"Email"}),e.jsx(E,{value:"ads",children:"Paid Ads"}),e.jsx(E,{value:"website",children:"Website"}),e.jsx(E,{value:"blog",children:"Blog"})]})]})]})]}),e.jsx(L,{onClick:z,disabled:_||!u.trim(),className:"w-full",size:"lg",children:_?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"w-4 h-4 mr-2 animate-spin"}),"Optimizing with AI..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Auto-Optimize with Learned Patterns"]})})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs(l,{className:"border-primary",children:[e.jsxs(m,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-primary"}),"Optimized Result"]}),e.jsxs(i,{variant:"default",children:[r.learningContext.patternsApplied," patterns applied"]})]}),e.jsxs(f,{children:["Based on ",r.learningContext.totalExamples," examples â€¢ Avg rating: ",r.learningContext.avgRating,"/5"]})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Optimized Prompt:"}),e.jsx("p",{className:"text-foreground whitespace-pre-wrap",children:r.optimizedPrompt})]}),r.expectedImpact&&e.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[r.expectedImpact.ctr&&e.jsxs(l,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ce,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"CTR Impact"})]}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:r.expectedImpact.ctr})]}),r.expectedImpact.engagement&&e.jsxs(l,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(X,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Engagement"})]}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:r.expectedImpact.engagement})]}),r.expectedImpact.conversion&&e.jsxs(l,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ne,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Conversion"})]}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:r.expectedImpact.conversion})]})]}),r.improvements&&r.improvements.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium",children:"Improvements Applied:"}),e.jsx("div",{className:"space-y-2",children:r.improvements.map((a,o)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-primary/5 rounded-lg",children:[e.jsx(D,{className:"w-4 h-4 text-primary mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:a})]},o))})]}),r.appliedPatterns&&r.appliedPatterns.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Learned Patterns Applied:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.appliedPatterns.map((a,o)=>e.jsx(i,{variant:"secondary",children:a},o))})]}),r.reasoning&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"AI Reasoning:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.reasoning})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"text-sm font-medium mb-3",children:"Rate this optimization:"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(a=>e.jsx(L,{variant:"outline",size:"sm",onClick:()=>F(a),children:a===5?e.jsx(Ne,{className:"w-4 h-4"}):a},a))})]})]})]}),r.variations&&r.variations.length>0&&e.jsxs(l,{children:[e.jsxs(m,{children:[e.jsx(x,{children:"A/B Test Variations"}),e.jsx(f,{children:"Test these variations to find the best performing version"})]}),e.jsx(p,{className:"space-y-3",children:r.variations.map((a,o)=>e.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${R===o?"border-primary bg-primary/5":"hover:border-primary/50"}`,onClick:()=>s(o),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{variant:"outline",children:a.type}),R===o&&e.jsx(i,{variant:"default",children:"Selected"})]}),e.jsx("p",{className:"text-sm",children:a.prompt})]},o))})]})]})]}),e.jsxs(C,{value:"analytics",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(l,{children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(x,{className:"text-sm font-medium",children:"Impressions"})]})}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-2xl font-bold",children:c.impressions}),e.jsx(L,{size:"sm",variant:"outline",onClick:()=>A("impressions",100),children:"+100"})]})})]}),e.jsxs(l,{children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(x,{className:"text-sm font-medium",children:"Clicks"})]})}),e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-2xl font-bold",children:c.clicks}),e.jsx(L,{size:"sm",variant:"outline",onClick:()=>A("clicks",10),children:"+10"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["CTR: ",q,"%"]})]})]}),e.jsxs(l,{children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(x,{className:"text-sm font-medium",children:"Conversions"})]})}),e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-2xl font-bold",children:c.conversions}),e.jsx(L,{size:"sm",variant:"outline",onClick:()=>A("conversions",1),children:"+1"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Rate: ",V,"%"]})]})]}),e.jsxs(l,{children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(x,{className:"text-sm font-medium",children:"Engagement"})]})}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-2xl font-bold",children:c.engagement}),e.jsx(L,{size:"sm",variant:"outline",onClick:()=>A("engagement",5),children:"+5"})]})})]})]}),e.jsxs(l,{children:[e.jsxs(m,{children:[e.jsx(x,{children:"Performance History"}),e.jsx(f,{children:"Track how your optimized prompts perform over time"})]}),e.jsx(p,{children:j.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(ie,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No performance data yet. Start optimizing prompts to track results!"})]}):e.jsx("div",{className:"space-y-3",children:j.map(a=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium line-clamp-1",children:a.optimized_prompt||a.original_prompt}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(a.created_at).toLocaleDateString()})]}),a.rating&&e.jsxs(i,{variant:"secondary",children:[a.rating,"/5 â­"]})]}),e.jsxs("div",{className:"flex gap-3 mt-3 text-xs",children:[a.ctr&&e.jsxs("span",{className:"text-muted-foreground",children:["CTR: ",a.ctr.toFixed(2),"%"]}),a.conversion_rate&&e.jsxs("span",{className:"text-muted-foreground",children:["Conv: ",a.conversion_rate.toFixed(2),"%"]}),a.engagement_score&&e.jsxs("span",{className:"text-muted-foreground",children:["Eng: ",a.engagement_score]})]})]},a.id))})})]})]}),e.jsx(C,{value:"insights",className:"space-y-6",children:e.jsxs(l,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-primary"}),"AI Learning Insights"]}),e.jsx(f,{children:"Patterns and best practices learned from your feedback"})]}),e.jsx(p,{children:e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(M,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Learning in Progress"}),e.jsxs("p",{className:"text-sm",children:["As you provide more feedback, AI will learn your unique patterns",e.jsx("br",{}),"and continuously improve optimization quality."]}),e.jsxs("div",{className:"mt-6",children:[e.jsx(U,{value:Math.min(j.length*10,100),className:"h-2"}),e.jsxs("p",{className:"text-xs mt-2",children:[j.length,"/10 examples for initial learning"]})]})]})})]})}),e.jsx(C,{value:"graph",children:e.jsx(be,{userId:h})})]})]})},Ze=()=>{const h=he(),[u,y]=n.useState(null),[b,w]=n.useState(!0);return n.useEffect(()=>{const{data:{subscription:S}}=N.auth.onAuthStateChange((v,_)=>{y((_==null?void 0:_.user)??null),_||h("/auth")});return N.auth.getSession().then(({data:{session:v}})=>{y((v==null?void 0:v.user)??null),v||h("/auth"),w(!1)}),()=>S.unsubscribe()},[h]),b?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-pulse-subtle",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin"})})}):e.jsx(fe,{user:u,showHeader:!1,children:e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-b from-background via-background to-muted/20",children:e.jsx("div",{className:"container-responsive mx-auto max-w-7xl py-8 sm:py-12 md:py-16 lg:py-20",children:e.jsx(we,{userId:(u==null?void 0:u.id)||""})})})})};export{Ze as default};
