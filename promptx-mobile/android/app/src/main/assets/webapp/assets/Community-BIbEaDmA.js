import{c as O,r as p,j as e,h as w,i as k,k as D,l as S,m as v,B as V,n as z}from"./index-C2MjUc6j.js";import{s as b}from"./index-z1pI4DUj.js";import{L as U}from"./Layout-lstxxF2Q.js";import{T as B,a as R,b as M,c as _}from"./tabs-CyOF3ppl.js";import{A as $,b as W}from"./avatar-DwxK4ALl.js";import{B as T}from"./badge-BmD5Ofur.js";import{a as E,U as K}from"./index-BOT--vBY.js";import{C as Z}from"./crown-D3TlBkXs.js";import{P as G}from"./progress-Dbp9893P.js";import{A as P}from"./award-qGEdKRCw.js";import{C as J}from"./circle-check-AANQYRHH.js";import{L as A}from"./lock-DoPTFIOb.js";import{F as Q}from"./flame-CCdSfuCi.js";import{S as I}from"./star-CvJAy4g_.js";import{D as ee}from"./download-HMPM07Ay.js";import{E as se}from"./eye-IzXR7YU-.js";import{t as f,c as te,e as ae,g as H,m as X,a as L,b as re}from"./en-US-CXXYYhpC.js";import"./index-C0NKCsYR.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=O("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=O("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),le=({userId:t})=>{const[s,a]=p.useState([]),[d,n]=p.useState([]),[u,x]=p.useState([]),[l,c]=p.useState(!0);p.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:o}=await b.from("leaderboard").select("*, profiles(username)").eq("category","weekly").order("rank",{ascending:!0}).limit(10),{data:m}=await b.from("leaderboard").select("*, profiles(username)").eq("category","monthly").order("monthly_score",{ascending:!1}).limit(10),{data:j}=await b.from("leaderboard").select("*, profiles(username)").eq("category","overall").order("total_score",{ascending:!1}).limit(10);a(g(o)),n(g(m)),x(g(j))}catch(o){console.error("Error loading leaderboards:",o)}finally{c(!1)}},g=o=>o?o.map((m,j)=>{var y;return{rank:m.rank||j+1,user_id:m.user_id,username:((y=m.profiles)==null?void 0:y.username)||"Anonymous",weekly_score:m.weekly_score||0,monthly_score:m.monthly_score||0,total_score:m.total_score||0}}):[],r=o=>{switch(o){case 1:return e.jsx(Z,{className:"w-6 h-6 text-yellow-500"});case 2:return e.jsx(Y,{className:"w-6 h-6 text-gray-400"});case 3:return e.jsx(Y,{className:"w-6 h-6 text-amber-700"});default:return e.jsxs("span",{className:"w-6 text-center font-bold text-muted-foreground",children:["#",o]})}},i=(o,m)=>{const j=m==="weekly"?"weekly_score":m==="monthly"?"monthly_score":"total_score";return e.jsx("div",{className:"space-y-3",children:o.map(y=>e.jsx(w,{className:`transition-all hover:shadow-lg ${y.user_id===t?"border-primary bg-primary/5":""}`,children:e.jsxs(v,{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12",children:r(y.rank)}),e.jsx($,{className:"h-10 w-10",children:e.jsx(W,{className:"bg-gradient-to-br from-primary to-primary/70 text-primary-foreground",children:y.username.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:y.username}),y.user_id===t&&e.jsx(T,{variant:"secondary",className:"text-xs",children:"You"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-xl font-bold",children:y[j].toLocaleString()})]})]})},y.user_id))})};return l?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e.jsx("div",{className:"space-y-6",children:e.jsxs(w,{children:[e.jsxs(k,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-6 h-6 text-yellow-500"}),"Leaderboards"]}),e.jsx(S,{children:"Compete with the best prompt engineers and climb the ranks"})]}),e.jsx(v,{children:e.jsxs(B,{defaultValue:"weekly",className:"w-full",children:[e.jsxs(R,{className:"grid w-full grid-cols-3",children:[e.jsx(M,{value:"weekly",children:"ðŸ“… Weekly"}),e.jsx(M,{value:"monthly",children:"ðŸ“† Monthly"}),e.jsx(M,{value:"alltime",children:"ðŸŒŸ All Time"})]}),e.jsx(_,{value:"weekly",className:"space-y-4 mt-6",children:s.length>0?i(s,"weekly"):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No weekly data yet. Be the first to compete!"})}),e.jsx(_,{value:"monthly",className:"space-y-4 mt-6",children:d.length>0?i(d,"monthly"):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No monthly data yet. Start earning points!"})}),e.jsx(_,{value:"alltime",className:"space-y-4 mt-6",children:u.length>0?i(u,"total"):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No all-time data yet. Make history!"})})]})})]})})},ce=({userId:t})=>{const[s,a]=p.useState([]),[d,n]=p.useState(!0);p.useEffect(()=>{t&&u()},[t]);const u=async()=>{try{const{data:r}=await b.from("badges").select("*").order("tier",{ascending:!0}),{data:i}=await b.from("user_achievements").select("badge_id, earned_at, progress").eq("user_id",t),o=i||[],m=new Set(o.map(N=>N.badge_id)),j=new Map(o.map(N=>[N.badge_id,N])),y=(r==null?void 0:r.map(N=>{var q,F;return{...N,earned:m.has(N.id),earned_at:(q=j.get(N.id))==null?void 0:q.earned_at,progress:(F=j.get(N.id))==null?void 0:F.progress}}))||[];a(y)}catch(r){console.error("Error loading badges:",r)}finally{n(!1)}},x=r=>{switch(r){case"platinum":return"from-cyan-400 to-blue-500";case"gold":return"from-yellow-400 to-orange-500";case"silver":return"from-gray-300 to-gray-500";case"bronze":return"from-amber-600 to-amber-800";default:return"from-gray-400 to-gray-600"}},l=r=>{switch(r){case"platinum":case"gold":return"default";case"silver":return"secondary";default:return"outline"}},c=r=>{if(r.earned)return 100;if(!r.progress)return 0;const i=r.requirements,o=r.progress;return i.prompts_created?Math.min(100,o.prompts_created/i.prompts_created*100):i.shares?Math.min(100,o.shares/i.shares*100):0};if(d)return e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})});const h=s.filter(r=>r.earned),g=s.filter(r=>!r.earned);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs(w,{children:[e.jsxs(k,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-6 h-6 text-primary"}),"Your Achievements (",h.length,")"]}),e.jsx(S,{children:"Badges you've earned through your excellence"})]}),e.jsx(v,{children:h.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map(r=>e.jsx(w,{className:`bg-gradient-to-br ${x(r.tier)} text-white border-0`,children:e.jsxs(v,{className:"p-6 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"text-4xl",children:r.icon}),e.jsx(J,{className:"w-6 h-6"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:r.name}),e.jsx("p",{className:"text-sm text-white/90",children:r.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{variant:l(r.tier),className:"text-xs uppercase",children:r.tier}),e.jsx("span",{className:"text-xs text-white/80",children:new Date(r.earned_at).toLocaleDateString()})]})]})},r.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No badges earned yet. Start creating prompts to unlock achievements!"})]})})]}),e.jsxs(w,{children:[e.jsxs(k,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-6 h-6 text-muted-foreground"}),"Available Badges (",g.length,")"]}),e.jsx(S,{children:"Unlock these badges by meeting the requirements"})]}),e.jsx(v,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(r=>{const i=c(r);return e.jsx(w,{className:"hover:shadow-lg transition-all",children:e.jsxs(v,{className:"p-6 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"text-4xl opacity-50",children:r.icon}),e.jsx(A,{className:"w-5 h-5 text-muted-foreground"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:r.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]}),e.jsx(T,{variant:l(r.tier),className:"text-xs uppercase",children:r.tier}),i>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(i),"%"]})]}),e.jsx(G,{value:i,className:"h-2"})]})]})},r.id)})})})]})]})};function C(t,s){const a=f(t),d=f(s),n=a.getTime()-d.getTime();return n<0?-1:n>0?1:n}function ie(t){return te(t,Date.now())}function de(t,s){const a=f(t),d=f(s),n=a.getFullYear()-d.getFullYear(),u=a.getMonth()-d.getMonth();return n*12+u}function oe(t){return s=>{const d=(t?Math[t]:Math.trunc)(s);return d===0?0:d}}function me(t,s){return+f(t)-+f(s)}function xe(t){const s=f(t);return s.setHours(23,59,59,999),s}function he(t){const s=f(t),a=s.getMonth();return s.setFullYear(s.getFullYear(),a+1,0),s.setHours(23,59,59,999),s}function ue(t){const s=f(t);return+xe(s)==+he(s)}function fe(t,s){const a=f(t),d=f(s),n=C(a,d),u=Math.abs(de(a,d));let x;if(u<1)x=0;else{a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-n*u);let l=C(a,d)===-n;ue(f(t))&&u===1&&C(t,d)===1&&(l=!1),x=n*(u-Number(l))}return x===0?0:x}function pe(t,s,a){const d=me(t,s)/1e3;return oe(a==null?void 0:a.roundingMethod)(d)}function ge(t,s,a){const d=re(),n=(a==null?void 0:a.locale)??d.locale??ae,u=2520,x=C(t,s);if(isNaN(x))throw new RangeError("Invalid time value");const l=Object.assign({},a,{addSuffix:a==null?void 0:a.addSuffix,comparison:x});let c,h;x>0?(c=f(s),h=f(t)):(c=f(t),h=f(s));const g=pe(h,c),r=(H(h)-H(c))/1e3,i=Math.round((g-r)/60);let o;if(i<2)return a!=null&&a.includeSeconds?g<5?n.formatDistance("lessThanXSeconds",5,l):g<10?n.formatDistance("lessThanXSeconds",10,l):g<20?n.formatDistance("lessThanXSeconds",20,l):g<40?n.formatDistance("halfAMinute",0,l):g<60?n.formatDistance("lessThanXMinutes",1,l):n.formatDistance("xMinutes",1,l):i===0?n.formatDistance("lessThanXMinutes",1,l):n.formatDistance("xMinutes",i,l);if(i<45)return n.formatDistance("xMinutes",i,l);if(i<90)return n.formatDistance("aboutXHours",1,l);if(i<X){const m=Math.round(i/60);return n.formatDistance("aboutXHours",m,l)}else{if(i<u)return n.formatDistance("xDays",1,l);if(i<L){const m=Math.round(i/X);return n.formatDistance("xDays",m,l)}else if(i<L*2)return o=Math.round(i/L),n.formatDistance("aboutXMonths",o,l)}if(o=fe(h,c),o<12){const m=Math.round(i/L);return n.formatDistance("xMonths",m,l)}else{const m=o%12,j=Math.trunc(o/12);return m<3?n.formatDistance("aboutXYears",j,l):m<9?n.formatDistance("overXYears",j,l):n.formatDistance("almostXYears",j+1,l)}}function je(t,s){return ge(t,ie(t),s)}const ye=()=>{const[t,s]=p.useState([]),[a,d]=p.useState([]),[n,u]=p.useState(!0);p.useEffect(()=>{x()},[]);const x=async()=>{try{const[c,h]=await Promise.all([b.from("trending_prompts").select("*").limit(10),b.from("top_rated_prompts").select("*").limit(10)]);c.data&&s(c.data),h.data&&d(h.data)}catch(c){console.error("Error fetching prompts:",c)}finally{u(!1)}},l=({prompt:c,rank:h})=>e.jsxs(w,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(k,{children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(T,{variant:"secondary",className:"text-xs",children:["#",h]}),e.jsx(T,{variant:"outline",className:"text-xs",children:c.category})]}),e.jsx(D,{className:"text-lg",children:c.title}),e.jsx(S,{className:"mt-1 line-clamp-2",children:c.description})]})})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-medium",children:c.avg_rating.toFixed(1)}),e.jsxs("span",{className:"text-muted-foreground",children:["(",c.rating_count,")"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:c.star_count})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{children:c.downloads})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{children:c.views})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-2xl font-bold",children:c.price===0?"FREE":`$${c.price.toFixed(2)}`}),e.jsx(V,{size:"sm",children:"View Details"})]}),c.created_at&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Added ",je(new Date(c.created_at),{addSuffix:!0})]})]})]});return n?e.jsx(w,{children:e.jsx(v,{className:"py-12 text-center",children:e.jsx("div",{className:"animate-pulse",children:"Loading trending prompts..."})})}):e.jsxs(w,{children:[e.jsxs(k,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-6 h-6 text-orange-500"}),e.jsx(D,{children:"Trending & Top Rated"})]}),e.jsx(S,{children:"Discover the most popular and highest-rated prompts in the community"})]}),e.jsx(v,{children:e.jsxs(B,{defaultValue:"trending",className:"w-full",children:[e.jsxs(R,{className:"grid w-full grid-cols-2",children:[e.jsxs(M,{value:"trending",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Trending"]}),e.jsxs(M,{value:"top-rated",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Top Rated"]})]}),e.jsx(_,{value:"trending",className:"mt-6 space-y-4",children:t.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No trending prompts yet"}):t.map((c,h)=>e.jsx(l,{prompt:c,rank:h+1},c.id))}),e.jsx(_,{value:"top-rated",className:"mt-6 space-y-4",children:a.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No rated prompts yet"}):a.map((c,h)=>e.jsx(l,{prompt:c,rank:h+1},c.id))})]})})]})},Fe=()=>{const t=z(),[s,a]=p.useState(null),[d,n]=p.useState(!0);return p.useEffect(()=>{const{data:{subscription:u}}=b.auth.onAuthStateChange((x,l)=>{a((l==null?void 0:l.user)??null),l||t("/auth")});return b.auth.getSession().then(({data:{session:x}})=>{a((x==null?void 0:x.user)??null),x||t("/auth"),n(!1)}),()=>u.unsubscribe()},[t]),d?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-pulse-subtle",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin"})})}):e.jsx(U,{user:s,showHeader:!1,children:e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-b from-background via-background to-muted/20",children:e.jsxs("div",{className:"container-responsive mx-auto max-w-6xl py-8 sm:py-12 md:py-16 lg:py-20",children:[e.jsxs("div",{className:"mb-6 sm:mb-8 md:mb-10 lg:mb-12 space-y-2 sm:space-y-3 md:space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold bg-gradient-to-r from-foreground to-foreground/70 bg-clip-text text-transparent leading-tight",children:"Community Hub"}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg lg:text-xl text-muted-foreground max-w-2xl leading-relaxed",children:"Compete, achieve, and share your prompt engineering excellence"})]}),e.jsxs(B,{defaultValue:"leaderboard",className:"w-full space-y-6 sm:space-y-8 md:space-y-10",children:[e.jsx("div",{className:"flex justify-center overflow-x-auto pb-2 -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(R,{className:"inline-flex h-11 sm:h-12 md:h-14 items-center justify-center rounded-xl bg-muted/50 p-1.5 text-muted-foreground backdrop-blur-sm border border-border/50 shadow-lg",children:[e.jsxs(M,{value:"leaderboard",className:"px-4 sm:px-6 md:px-8 py-2 sm:py-2.5 md:py-3 rounded-lg text-sm sm:text-base font-semibold whitespace-nowrap",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Leaderboard"]}),e.jsxs(M,{value:"trending",className:"px-4 sm:px-6 md:px-8 py-2 sm:py-2.5 md:py-3 rounded-lg text-sm sm:text-base font-semibold whitespace-nowrap",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Trending"]}),e.jsxs(M,{value:"badges",className:"px-4 sm:px-6 md:px-8 py-2 sm:py-2.5 md:py-3 rounded-lg text-sm sm:text-base font-semibold whitespace-nowrap",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Achievements"]})]})}),e.jsx(_,{value:"leaderboard",className:"mt-0 space-y-6",children:e.jsx(le,{userId:s==null?void 0:s.id})}),e.jsx(_,{value:"trending",className:"mt-0 space-y-6",children:e.jsx(ye,{})}),e.jsx(_,{value:"badges",className:"mt-0 space-y-6",children:e.jsx(ce,{userId:s==null?void 0:s.id})})]})]})})})};export{Fe as default};
